# Создание и уничтожение потоков

Базовая структура многопоточной программы, взятая за основу всех работ, выглядит следующим образом:

1.	Описываются поточные функции, соответствующие потокам программы.
2.	В основной программе создаются потоки на основе поточных функций.
3.	После создания потоков основная программа приостанавливает выполнение и ожидает команды завершения.
4.	При поступлении команды завершения основная программа формирует команды завершения потоков.
5.	Основная программа переходит к ожиданию завершения потоков.
6.	После завершения потоков основная программа завершает свою работу.

Создание потока в стандарте `POSIX` осуществляется следующим вызовом:
```cpp
int pthread_create(pthread_t *thread, const pthread_attr_t *attr,
    void *(*start_routine) (void *), void *arg),
```

где:</br>
`thread` – указатель на идентификатор потока;</br>
`attr` – указатель на структуру данных, описывающих атрибуты потока;</br>
`start_routine` – имя функции, выполняющей роль потока;</br>
`arg` - указатель на структуру данных, описывающих передаваемые в поток параметры.</br>

Завершение работы потока может быть выполнено несколькими способами.
1.	Вызовом оператора `return` из функции потока;
2.	Вызовом функции: `int pthread_cancel(pthread_t thread);` из другого потока;</br>
3.	Вызовом функции: `int pthread_exit(void *value_ptr)`</br>

В последнем случае появляется возможность через переменную `value_ptr` передать в основной поток “код завершения”.
При этом необходимо синхронизировать завершение с основным потоком, используя следующую функцию:
 
```cpp
int pthread_join(pthread_t thread, void **retval),
```
где:</br>
`thread` – идентификатор потока;</br>
`retval` – код завершения потока, переданный через функцию `pthread_exit`.</br>
Функция, выполняющая роль потока, создается на основе следующего шаблона:

```cpp
static void * thread_start(void *arg).
```

## Указания к выполнению работы

Написать программу, содержащую два потока (в дополнение к основному потоку). Каждый из потоков должен выводить определенное число на экран.
При запуске потоков передать в них адреса флагов завершения, при этом объявить флаги завершения локальными в функции `main()`.
При завершении потоков выставить некоторые значения кодов завершения, а затем прочитать эти коды завершения в функции `main()`.
